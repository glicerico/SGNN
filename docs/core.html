---

title: SGNN


keywords: fastai
sidebar: home_sidebar

summary: "Implementation of Self-Governing Neural Networks for speech act classification"
description: "Implementation of Self-Governing Neural Networks for speech act classification"
nb_path: "00_core.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: 00_core.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>/home/andres/src/miniconda3/envs/speechActs/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:516: FutureWarning: Passing (type, 1) or &#39;1type&#39; as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / &#39;(1,)type&#39;.
  _np_qint8 = np.dtype([(&#34;qint8&#34;, np.int8, 1)])
/home/andres/src/miniconda3/envs/speechActs/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:517: FutureWarning: Passing (type, 1) or &#39;1type&#39; as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / &#39;(1,)type&#39;.
  _np_quint8 = np.dtype([(&#34;quint8&#34;, np.uint8, 1)])
/home/andres/src/miniconda3/envs/speechActs/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:518: FutureWarning: Passing (type, 1) or &#39;1type&#39; as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / &#39;(1,)type&#39;.
  _np_qint16 = np.dtype([(&#34;qint16&#34;, np.int16, 1)])
/home/andres/src/miniconda3/envs/speechActs/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:519: FutureWarning: Passing (type, 1) or &#39;1type&#39; as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / &#39;(1,)type&#39;.
  _np_quint16 = np.dtype([(&#34;quint16&#34;, np.uint16, 1)])
/home/andres/src/miniconda3/envs/speechActs/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:520: FutureWarning: Passing (type, 1) or &#39;1type&#39; as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / &#39;(1,)type&#39;.
  _np_qint32 = np.dtype([(&#34;qint32&#34;, np.int32, 1)])
/home/andres/src/miniconda3/envs/speechActs/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:525: FutureWarning: Passing (type, 1) or &#39;1type&#39; as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / &#39;(1,)type&#39;.
  np_resource = np.dtype([(&#34;resource&#34;, np.ubyte, 1)])
/home/andres/src/miniconda3/envs/speechActs/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:541: FutureWarning: Passing (type, 1) or &#39;1type&#39; as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / &#39;(1,)type&#39;.
  _np_qint8 = np.dtype([(&#34;qint8&#34;, np.int8, 1)])
/home/andres/src/miniconda3/envs/speechActs/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:542: FutureWarning: Passing (type, 1) or &#39;1type&#39; as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / &#39;(1,)type&#39;.
  _np_quint8 = np.dtype([(&#34;quint8&#34;, np.uint8, 1)])
/home/andres/src/miniconda3/envs/speechActs/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:543: FutureWarning: Passing (type, 1) or &#39;1type&#39; as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / &#39;(1,)type&#39;.
  _np_qint16 = np.dtype([(&#34;qint16&#34;, np.int16, 1)])
/home/andres/src/miniconda3/envs/speechActs/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:544: FutureWarning: Passing (type, 1) or &#39;1type&#39; as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / &#39;(1,)type&#39;.
  _np_quint16 = np.dtype([(&#34;quint16&#34;, np.uint16, 1)])
/home/andres/src/miniconda3/envs/speechActs/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:545: FutureWarning: Passing (type, 1) or &#39;1type&#39; as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / &#39;(1,)type&#39;.
  _np_qint32 = np.dtype([(&#34;qint32&#34;, np.int32, 1)])
/home/andres/src/miniconda3/envs/speechActs/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:550: FutureWarning: Passing (type, 1) or &#39;1type&#39; as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / &#39;(1,)type&#39;.
  np_resource = np.dtype([(&#34;resource&#34;, np.ubyte, 1)])
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Required-modules">Required modules<a class="anchor-link" href="#Required-modules"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Import-data-from-file">Import data from file<a class="anchor-link" href="#Import-data-from-file"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="import_data" class="doc_header"><code>import_data</code><a href="https://github.com/glicerico/SGNN/tree/master/SGNN/core.py#L27" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>import_data</code>(<strong><code>filepath</code></strong>)</p>
</blockquote>
<p>Imports data from file and removes empty entries
:param filepath:  Path to file with SwDa utterances in format "ActTag,Text"
:return:          pandas dataframe with the data</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Preprocess-data,-and-divide-it-in-train,-validation-and-test-sets">Preprocess data, and divide it in train, validation and test sets<a class="anchor-link" href="#Preprocess-data,-and-divide-it-in-train,-validation-and-test-sets"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="preprocess_data" class="doc_header"><code>preprocess_data</code><a href="https://github.com/glicerico/SGNN/tree/master/SGNN/core.py#L40" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>preprocess_data</code>(<strong><code>data</code></strong>, <strong><code>lowercase</code></strong>=<em><code>False</code></em>, <strong><code>clean</code></strong>=<em><code>False</code></em>, <strong><code>remove_continuations</code></strong>=<em><code>True</code></em>)</p>
</blockquote>
<p>Preprocess the data according to parameters.
Divides the data into training, validation and test sets.</p>
<p>:param data:  Pandas dataframe imported by <a href="/SGNN/core.html#import_data"><code>import_data</code></a>
Optional:
:param lowercase:  Convert all text to lowercase
:param clean:  Remove punctuation marks and non-verbal utterances
:param remove_continuations:  Remove utterances with act tag "+"</p>
<p>:return:  Pandas series with training, validation and test tags and utterances</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Transform-RandomBinaryProjections-to-transformer">Transform RandomBinaryProjections to transformer<a class="anchor-link" href="#Transform-RandomBinaryProjections-to-transformer"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="Transformer_RBP" class="doc_header"><code>class</code> <code>Transformer_RBP</code><a href="https://github.com/glicerico/SGNN/tree/master/SGNN/core.py#L73" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>Transformer_RBP</code>(<strong><code>hash_name</code></strong>=<em><code>'hasher'</code></em>, <strong><code>projection_count</code></strong>=<em><code>1</code></em>, <strong><code>rand_seed</code></strong>=<em><code>None</code></em>) :: <code>BaseEstimator</code></p>
</blockquote>
<p>Class that modifies RandomBinaryProjections to use as an sklearn transformer</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Create-input-layer-projections">Create input layer projections<a class="anchor-link" href="#Create-input-layer-projections"> </a></h2><p>This is the main contribution of the SGNN paper, and the implementation is inspired by Guillaume Chevalier's <a href="https://github.com/guillaume-chevalier/SGNN-Self-Governing-Neural-Networks-Projection-Layer">implementation</a>, as well as his <a href="https://github.com/guillaume-chevalier/SGNN-Self-Governing-Neural-Networks-Projection-Layer/issues/1">discussion</a> with <a href="https://github.com/thinline">Sava Kalbachou</a>.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="build_input_layer" class="doc_header"><code>build_input_layer</code><a href="https://github.com/glicerico/SGNN/tree/master/SGNN/core.py#L115" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>build_input_layer</code>(<strong><code>T</code></strong>=<em><code>80</code></em>, <strong><code>d</code></strong>=<em><code>14</code></em>)</p>
</blockquote>
<p>Transformer to build the input layer, in SGNN style.
Uses nltk skipgrams, and several Transformer_RBP layers as elements of the SGNN pipeline.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Create-keras-model">Create keras model<a class="anchor-link" href="#Create-keras-model"> </a></h2><p>Following the SGNN paper's architecture</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="build_keras_model" class="doc_header"><code>build_keras_model</code><a href="https://github.com/glicerico/SGNN/tree/master/SGNN/core.py#L163" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>build_keras_model</code>(<strong><code>train_labels</code></strong>)</p>
</blockquote>
<p>Build keras model, with two hidden layers as the SGNN paper.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Main-process,-putting-together-previous-functions">Main process, putting together previous functions<a class="anchor-link" href="#Main-process,-putting-together-previous-functions"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="main" class="doc_header"><code>main</code><a href="https://github.com/glicerico/SGNN/tree/master/SGNN/core.py#L191" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>main</code>(<strong><code>lowercase</code></strong>=<em><code>False</code></em>, <strong><code>clean</code></strong>=<em><code>False</code></em>, <strong><code>remove_continuations</code></strong>=<em><code>True</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

</div>
 

